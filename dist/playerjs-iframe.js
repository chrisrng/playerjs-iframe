!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("playerjs-iframe",[],t):"object"==typeof exports?exports["playerjs-iframe"]=t():e["playerjs-iframe"]=t()}(this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return e[o].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="/",t(0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(this.Adapter=f["default"][e.adapter],!this.Adapter)throw new Error("No adapter for "+e.adapter);this.config=e,this.messenger=new s["default"]({context:c["default"].CONTEXT})}Object.defineProperty(t,"__esModule",{value:!0});var u=n(1),a=o(u),i=n(2),s=o(i),l=n(6),f=o(l),d=n(4),c=o(d);t["default"]=r,r.addAdapter=function(e,t){f["default"][e]=t},r.Thenable=a["default"],Object.keys(c["default"]).forEach(function(e){r[e]=c["default"][e]}),r.prototype.load=function(){var e=this.messenger,t=new this.Adapter(this.config,this.messenger);return new a["default"](function(n,o){t.load().then(function(t){(t.supported&&t.supported.methods||[]).forEach(function(n){e.on(n,function(e,o){t[n](o)})}),t.supported&&t.supported.events&&(t.supported.methods=(t.supported.methods||[]).concat([c["default"].METHODS.ADDEVENTLISTENER,c["default"].METHODS.REMOVEEVENTLISTENER])),e.emit({event:c["default"].EVENTS.READY,value:{src:window.location.href,events:t.supported&&t.supported.events,methods:t.supported&&t.supported.methods}}),n(t)})})},e.exports=t["default"]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){this.state?e[this.state]&&e[this.state](this.data):this.callbacks.push(e)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function(){function e(t){function r(e,t){this.state||(this.state=e,this.data=t,this.callbacks.forEach(o.bind(this)),this.callbacks=[])}n(this,e),this.callbacks=[],this.state,this.data,t(r.bind(this,"fulfill"),r.bind(this,"reject"))}return r(e,[{key:"then",value:function(e,t){o.call(this,{fulfill:e,reject:t})}}]),e}();t["default"]=u,e.exports=t["default"]},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=this;this.config=e||{},this.listeners={},this.on(l["default"].METHODS.ADDEVENTLISTENER,function(e,n){t.listeners[n.value]=new d["default"](t.listeners[n.value]),t.listeners[n.value].add(n.listener),i["default"].log("[messenger#addEventListener]",n)}),this.on(l["default"].METHODS.REMOVEEVENTLISTENER,function(e,n){t.listeners[n.value]&&t.listeneres[n.value].remove(n.listener),i["default"].log("[messenger#removeEventListener]",n)})}function u(e){window.parent.postMessage(JSON.stringify(e),"*")}Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),i=o(a),s=n(4),l=o(s),f=n(5),d=o(f);t["default"]=r,r.prototype.emit=function(e){var t=this;if("string"==typeof e&&(e={event:e}),e=Object.keys(this.config).reduce(function(e,n){return e.hasOwnProperty(n)||(e[n]=t.config[n]),e},e||{}),e.event===l["default"].EVENTS.READY)u(e);else{var n=e.listener?[e.listener]:this.listeners[e.event]||[];n.forEach(function(t){e.listener=t,i["default"].log("[messenger#emit]",e),u(e)})}return this},r.prototype.on=function(e,t){var n=this;return window.addEventListener("message",function(o){try{var r=JSON.parse(o.data);n.config.context&&r.context!==n.config.context||r.method===e&&t&&t(r.value,r)}catch(u){}}),this},r.prototype.returns=function(e,t){e.value=t,e.event=e.method||e.event,delete e.method,this.emit(e)},e.exports=t["default"]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={log:function(){window.DEBUG&&window.console&&window.console.log.apply(window.console,Array.prototype.slice.call(arguments))}},e.exports=t["default"]},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={CONTEXT:"player.js",EVENTS:{READY:"ready",PLAY:"play",PAUSE:"pause",ENDED:"ended",TIMEUPDATE:"timeupdate",PROGRESS:"progress",ERROR:"error"},METHODS:{PLAY:"play",PAUSE:"pause",GETPAUSED:"getPaused",MUTE:"mute",UNMUTE:"unmute",GETMUTED:"getMuted",SETVOLUME:"setVolume",GETVOLUME:"getVolume",GETDURATION:"getDuration",SETCURRENTTIME:"setCurrentTime",GETCURRENTTIME:"getCurrentTime",SETLOOP:"setLoop",GETLOOP:"getLoop",REMOVEEVENTLISTENER:"removeEventListener",ADDEVENTLISTENER:"addEventListener"}},e.exports=t["default"]},function(e,t){"use strict";function n(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];return e.add=e.add||function(t){return-1===e.indexOf(e)?(e.push(t),e):void 0},e.remove=e.remove||function(t){var n=e.indexOf(t);return-1!==n?(e.splice(n,1),e):void 0},e}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n,e.exports=t["default"]},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(7),u=o(r),a=n(11),i=o(a);t["default"]={vimeo:u["default"],youtube:i["default"]},e.exports=t["default"]},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(8),l=n(1),f=o(l),d=n(9),c=o(d),p=n(4),h=o(p),y=n(10),v=o(y),m=n(3),E=(o(m),"//f.vimeocdn.com/js/froogaloop2.min.js"),g={methods:["play","pause","paused","seekTo","unload","getCurrentTime","getDuration","getVideoEmbedCode","getVideoHeight","getVideoWidth","getVideoUrl","getColor","setColor","setLoop","getVolume","setVolume","setCurrentTime","mute","unmute"],events:["play","paused","ended"]},b=function(e){function t(e,n,o){r(this,t);var a=u(this,Object.getPrototypeOf(t).call(this,e,n)),i=e.url.split("/").pop(),s=new c["default"]("https://player.vimeo.com/video/"+i+"?api=1");return a.supported=g,s.appendTo(document.body),a.player=$f(s.iframe),a.player.addEvent("ready",function(){a.player.addEvent("play",function(){a.messenger.emit(h["default"].EVENTS.PLAY)}),a.player.addEvent("pause",function(){a.messenger.emit(h["default"].EVENTS.PAUSE)}),a.player.addEvent("finish",function(){a.messenger.emit(h["default"].EVENTS.ENDED)}),o(a)}),a}return a(t,e),i(t,[{key:"play",value:function(){this.player.api("play")}},{key:"pause",value:function(){this.player.api("pause")}},{key:"getPaused",value:function(){}},{key:"mute",value:function(){this.lastVolume=this.getVolume(),this.player.api("setVolume",0)}},{key:"unmute",value:function(){this.player.api("setVolume",this.lastVolume)}},{key:"getMuted",value:function(){}},{key:"setVolume",value:function(e){this.player.api("setVolume",(e/100).toFixed(2))}},{key:"getVolume",value:function(){return 100*this.player.api("getVolume")}},{key:"getDuration",value:function(e){var t=this;this.player.api("getDuration",function(n){t.messenger.returns(e,n)})}},{key:"setCurrentTime",value:function(e){this.player.api("seekTo",e.value)}},{key:"getCurrentTime",value:function(){}}]),t}(s.BaseVideoAdapter),T=function(e){function t(){return r(this,t),u(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),i(t,[{key:"load",value:function(){var e=this;return new f["default"](function(t,n){(0,v["default"])(E).then(function(){new b(e.config,e.messenger,t)})})}}]),t}(s.BaseServiceAdapter);t["default"]=T,e.exports=t["default"]},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(){var e=this;window.addEventListener("message",function(t){var n=t.data||"";e.supports("method",n)&&e[n]()})}Object.defineProperty(t,"__esModule",{value:!0}),t.BaseVideoAdapter=t.BaseServiceAdapter=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(3);o(i),t.BaseServiceAdapter=function(){function e(t,n){r(this,e),this.config=t,this.messenger=n}return a(e,[{key:"load",value:function(){}}]),e}(),t.BaseVideoAdapter=function(){function e(t,n){r(this,e),this.config=t,this.messenger=n,this.supported={events:[],methods:[]},u.call(this)}return a(e,[{key:"supports",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?"":arguments[1],n=void 0;if("method"===e)n="methods";else{if("event"!==e)return!1;n="events"}return this.supported[n].indexOf(t)>-1}}]),e}()},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u={id:"player",width:"100%",height:"100%",frameBorder:"0",scrolling:"no",allowfullscreen:"1"},a=function(){function e(t,r){var a=this;n(this,e),r=o({},u,r),this.iframe=document.createElement("iframe"),Object.keys(r).forEach(function(e){a.iframe.setAttribute(e,r[e])}),this.iframe.src=t}return r(e,[{key:"appendTo",value:function(e){e&&e.appendChild(this.iframe)}}]),e}();t["default"]=a,e.exports=t["default"]},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e){return new a["default"](function(t,n){var o=document.createElement("script");o.async=!0,(document.head||document.body).appendChild(o),o.onload=o.onreadystatechange=function(e,r){(r||!o.readyState||/loaded|complete/.test(o.readyState))&&(o.onload=o.onreadystatechange=null,o=void 0,r?n():t())},o.src=e})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var u=n(1),a=o(u);e.exports=t["default"]},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(8),l=n(1),f=o(l),d=n(4),c=o(d),p=n(10),h=o(p),y=n(3),v=o(y),m="//www.youtube.com/iframe_api",E=function(e){function t(e,n,o){r(this,t);var a=u(this,Object.getPrototypeOf(t).call(this,e,n)),i=document.createElement("div"),s=new URL(e.url);return document.body.appendChild(i),a.listeners={},a.supported={events:["play","paused","ended","error"],methods:["play","pause","getDuration","setCurrentTime"]},a.player=new YT.Player(i,{height:"100%",width:"100%",videoId:s.searchParams.get("v"),events:{onReady:function(){o(a),v["default"].log("[youtube#event:ready]")},onError:function(){a.messenger.emit({event:c["default"].EVENTS.ERROR,value:{code:-1,msg:"something went wrong"}}),v["default"].log("[youtube#event:error]")},onStateChange:function(e){var t={0:c["default"].EVENTS.ENDED,1:c["default"].EVENTS.PLAY,2:c["default"].EVENTS.PAUSE};t[e.data]&&(v["default"].log("[youtube#event:%s]",t[e.data]),a.messenger.emit(t[e.data]))}}}),a}return a(t,e),i(t,[{key:"play",value:function(){this.player.playVideo(),v["default"].log("[youtube#method:play]")}},{key:"pause",value:function(){this.player.pauseVideo(),v["default"].log("[youtube#method:pause]")}},{key:"mute",value:function(){this.player.mute(),v["default"].log("[youtube#method:mute]")}},{key:"unmute",value:function(){this.player.unMute(),v["default"].log("[youtube#method:unmute]")}},{key:"getDuration",value:function(e){var t=this.player.getDuration();this.messenger.returns(e,t),v["default"].log("[youtube#method:getDuration]",t)}},{key:"setCurrentTime",value:function(e){this.player.seekTo(e.value),v["default"].log("[youtube#method:setCurrentTime]",e.value)}}]),t}(s.BaseVideoAdapter),g=function(e){function t(){return r(this,t),u(this,Object.getPrototypeOf(t).apply(this,arguments))}return a(t,e),i(t,[{key:"load",value:function(){var e=this;return new f["default"](function(t,n){window.onYouTubeIframeAPIReady=function(){new E(e.config,e.messenger,t)},(0,h["default"])(m)})}}]),t}(s.BaseServiceAdapter);t["default"]=g,e.exports=t["default"]}])});