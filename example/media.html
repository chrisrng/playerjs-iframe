<!DOCTYPE html>
<html>
<head>
  <style>
    html,
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100vh;
      width: 100vw;
    }
  </style>
</head>
<body>
<script src="/playerjs-iframe.js"></script>
<script>
  (function () {
    function getVideoId(schema, url) {
      var urlObj = new URL(url);
      var videoId;

      switch (schema) {
        case 'vimeo':
          videoId = urlObj.pathname.split('/')[1];
          break;

        case 'youtube':
          videoId = urlObj.searchParams.get('v');
          break;

        default:
          videoId = '';
      }

      return videoId;
    }

    var iframeUrl = new URL(window.location.href);

    var image = iframeUrl.searchParams.get('image');
    var schema = iframeUrl.searchParams.get('schema');
    var src = iframeUrl.searchParams.get('src');
    var type = iframeUrl.searchParams.get('type');
    var url = iframeUrl.searchParams.get('url');

    var referrer = document.referrer;
    var URL_PATTERN = /^https?:\/\/([A-Za-z0-9-_\.]+)(:[0-9]+)?/;

    var config = {
      image: image,
      schema: schema,
      src: src,
      type: type,
      url: url,
      videoId: getVideoId(schema, url),
      targetOrigin: referrer && referrer.match(URL_PATTERN)[0]
    };

    var player = window.playerjsIframe.create(config);
  })();
</script>
</body>
</html>
